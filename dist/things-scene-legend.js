!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@hatiolab/things-scene")):"function"==typeof define&&define.amd?define(["exports","@hatiolab/things-scene"],t):t((e=e||self)["things-scene-legend"]={},e.scene)}(this,function(e,t){"use strict";const o={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"rows",name:"rows"},{type:"number",label:"columns",name:"columns"},{type:"select",label:"direction",name:"direction",property:{options:[{display:"Horizontal",value:"horizontal"},{display:"Vertical",value:"vertical"}]}},{type:"number",label:"round",name:"round"},{type:"legend-status",label:"",name:"status"}]};var n={ondragmove:function(e,t,o){var{left:n,top:i,width:l,height:a}=o.model,s=(o.transcoordP2S(e.x,e.y).x-n)/(l/2)*100;s=r(s,l,a),o.set({round:s})}};function r(e,t,o){var n=t>o?o/t*100:100;return e>=n?e=n:e<=0&&(e=0),e}class i extends t.Container{ready(){this.rebuildLegendItems()}get showMoveHandle(){return!1}render(e){var{round:t=0}=this.model,{left:o,top:n,width:i,height:l}=this.bounds;if(e.beginPath(),(t=r(t,i,l))>0){var a=t/100*(i/2);e.moveTo(o+a,n),e.lineTo(o+i-a,n),e.quadraticCurveTo(o+i,n,o+i,n+a),e.lineTo(o+i,n+l-a),e.quadraticCurveTo(o+i,n+l,o+i-a,n+l),e.lineTo(o+a,n+l),e.quadraticCurveTo(o,n+l,o,n+l-a),e.lineTo(o,n+a),e.quadraticCurveTo(o,n,o+a,n),this.model.padding={top:t/2,left:t/2,right:t/2,bottom:t/2}}else e.rect(o,n,i,l);this.drawFill(e),this.drawStroke(e)}get controls(){var{left:e,top:t,width:o,round:i,height:l}=this.model;return[{x:e+o/2*((i=null==i?0:r(i,o,l))/100),y:t,handler:n}]}get layout(){return t.TableLayout}get nature(){return o}rebuildLegendItems(){this.components.length&&this.components.slice().forEach(e=>e.dispose());var{left:e,top:o,width:n,height:r,fillStyle:i,strokeStyle:l,fontColor:a,fontFamily:s,fontSize:d,lineHeight:h,textAlign:u="left",round:c=0,italic:g,bold:m,lineWidth:p=0,rows:f,columns:b,status:y={}}=this.model;let v=y.ranges||[];var f,b,w=v.length;this.add(v.map(e=>t.Model.compile({type:"legend-item",text:e.description||`${e.min||""} ~ ${e.max||""}`,width:1,height:1,color:e.color,fontColor:a,fontFamily:s,fontSize:d,lineHeight:h,italic:g,bold:m,textAlign:u}))),b||f?b&&!f?f=Math.ceil(w/Number(b)):f&&!b&&(b=Math.ceil(w/Number(f))):(f=w,b=1),this.set({layoutConfig:{rows:f,columns:b}})}get hasTextProperty(){return!0}get textHidden(){return!0}onchange(e,t){this.rebuildLegendItems()}}t.Component.register("legend",i);const l={mutable:!1,resizable:!1,rotatable:!1,properties:[]};class a extends(t.RectPath(t.Shape)){render(e){var{left:t,top:o,height:n,color:r}=this.model;e.beginPath();var i=n/2,l=i/2;e.save(),e.fillStyle=r,e.ellipse(t+i,o+i,l,l,0,0,2*Math.PI,!0),e.shadowColor="rgba(0,0,0,0.15)",e.shadowBlur=2,e.shadowOffsetX=1,e.shadowOffsetY=2,e.fill(),e.restore()}onchange(e){e.hasOwnProperty("height")&&this.set("paddingLeft",e.height)}get stuck(){return!0}get capturable(){return!1}get nature(){return l}}t.Component.register("legend-item",a),e.Legend=i,e.LegendItem=a,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=things-scene-legend.js.map
