!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);Object.defineProperty(t,"Legend",{enumerable:!0,get:function(){return r(o).default}});var i=n(2);Object.defineProperty(t,"LegendItem",{enumerable:!0,get:function(){return r(i).default}})},function(e,t,n){"use strict";function r(e,t,n){var r=t>n?n/t*100:100;return e>=r?e=r:e<=0&&(e=0),e}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"target",name:"target"},{type:"number",label:"rows",name:"rows"},{type:"number",label:"columns",name:"columns"},{type:"select",label:"direction",name:"direction",property:{options:[{display:"Horizontal",value:"horizontal"},{display:"Vertical",value:"vertical"}]}},{type:"number",label:"round",name:"round"}]},a={ondragmove:function(e,t,n){var o=n.model,i=o.left,a=(o.top,o.width),u=o.height,l=(n.transcoordP2S(e.x,e.y).x-i)/(a/2)*100;l=r(l,a,u),n.set({round:l})}},u=scene,l=u.Model,s=u.Container,c=u.TableLayout,f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s),o(t,[{key:"ready",value:function(){this.rebuildLegendItems()}},{key:"_draw",value:function(e){var t=this.model.round,n=void 0===t?0:t,o=this.bounds,i=o.left,a=o.top,u=o.width,l=o.height;if(e.beginPath(),(n=r(n,u,l))>0){var s=n/100*(u/2);e.moveTo(i+s,a),e.lineTo(i+u-s,a),e.quadraticCurveTo(i+u,a,i+u,a+s),e.lineTo(i+u,a+l-s),e.quadraticCurveTo(i+u,a+l,i+u-s,a+l),e.lineTo(i+s,a+l),e.quadraticCurveTo(i,a+l,i,a+l-s),e.lineTo(i,a+s),e.quadraticCurveTo(i,a,i+s,a),this.model.padding={top:n/2,left:n/2,right:n/2,bottom:n/2}}else e.rect(i,a,u,l);this.drawFill(e),this.drawStroke(e)}},{key:"onTargetChanged",value:function(e,t){e.hasOwnProperty("stockStatus")&&t.hasOwnProperty("stockStatus")&&this.rebuildLegendItems()}},{key:"rebuildLegendItems",value:function(){if(this.components.slice().forEach(function(e){return e.dispose()}),this.target){var e=this.model,t=(e.left,e.top,e.width,e.height,e.fillStyle,e.strokeStyle,e.fontColor),n=e.fontFamily,r=e.fontSize,o=e.lineHeight,i=e.textAlign,a=void 0===i?"left":i,u=(e.round,e.italic),s=e.bold,c=(e.lineWidth,e.rows),f=e.columns,h=this.target.model.stockStatus.ranges,p=h.length;this.add(h.map(function(e){return l.compile({type:"legend-item",text:(e.min||"")+" ~ "+(e.max||""),width:1,height:1,color:e.color,fontColor:t,fontFamily:n,fontSize:r,lineHeight:o,italic:u,bold:s,textAlign:a})})),f||c?f&&!c?c=Math.ceil(p/Number(f)):c&&!f&&(f=Math.ceil(p/Number(c))):(c=p,f=1),this.set({rows:c,columns:f})}}},{key:"dispose",value:function(){this._target&&this._target.off("change",this.onTargetChanged,this),delete this._target,function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"onchange",value:function(e,t){(t.hasOwnProperty("target")||e.hasOwnProperty("target"))&&this._target&&this._target.off("change",this.onTargetChanged,this),this.rebuildLegendItems()}},{key:"controls",get:function(){var e=this.model,t=e.left,n=e.top,o=e.width,i=e.round,u=e.height;return i=void 0==i?0:r(i,o,u),[{x:t+o/2*(i/100),y:n,handler:a}]}},{key:"layout",get:function(){return c}},{key:"target",get:function(){var e=this.model.target;return!this._target&&e&&(this._target=this.root.findById(e),this._target&&this._target.on("change",this.onTargetChanged,this)),this._target}},{key:"nature",get:function(){return i}}]),t}();t.default=f,scene.Component.register("legend",f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o={mutable:!1,resizable:!1,rotatable:!1,properties:[]},i=scene,a=(i.Model,i.Component,i.RectPath),u=i.Shape,l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a(u)),r(t,[{key:"_draw",value:function(e){var t=this.model,n=t.left,r=t.top,o=t.height,i=t.color;e.beginPath();var a=o/2,u=a/2;e.save(),e.fillStyle=i,e.ellipse(n+a,r+a,u,u,0,0,2*Math.PI,!0),e.shadowColor="#777",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.fill(),e.restore()}},{key:"onchange",value:function(e){e.hasOwnProperty("height")&&this.set("paddingLeft",e.height)}},{key:"stuck",get:function(){return!0}},{key:"capturable",get:function(){return!1}},{key:"nature",get:function(){return o}}]),t}();t.default=l,scene.Component.register("legend-item",l)}]);